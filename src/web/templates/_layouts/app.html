{% extends "_layouts/base.html" %}
{% import "_macros/menu.html" as Menu %}
{% block base_head %}
{% block head %}
  
{% endblock %}
{% endblock %}
{% block base_body %}
<style>
  #dropdownButton2 div {
    transition: transform 0.3s ease, opacity 0.3s ease;
  }
  
  #dropdownButton2.clicked div:first-child {
    transform: rotate(-30deg); 
  }
  #dropdownButton2.clicked div:nth-child(2) {
    opacity: 0;
  }
  #dropdownButton2.clicked div:last-child {
    transform: rotate(30deg);
  }
</style>
<div class="relative bodyContainer h-full flex flex-col overflow-hidden">
  <header class="flex-none flex justify-between p-2 md:px-3 border-b shadow border-zinc-900 bg-cyan-700 text-white">
    <div class="ml-2 flex items-center gap-2 group">
      <a href="/">
          <img src="/static/img/Logo.png" alt="Hope Trade Logo" class="w-12 h-12" />
      </a>
      <!-- En pantallas pequeñas, el texto no tiene animación -->
      <a href="/" class="relative overflow-hidden">
          <span class="inline-block text-xl font-medium md:transition-transform md:duration-500 md:transform md:-translate-x-full md:group-hover:translate-x-0">
              HopeTrade
          </span>
      </a>
    </div>  

    <!-- <div class="ml-2 flex items-center gap-2">
      <a href="/">
          <img src="/static/img/Logo.png" alt="Hope Trade Logo" class='w-12 h-12' />
      </a>
      <a href="/" class="relative group overflow-hidden inline-block">
          <span class="absolute left-full group-hover:left-0 transition-all duration-500 text-xl font-medium">HopeTrade</span>
      </a>
    </div> -->
  
    <nav class="flex md:mr-2">
      <div class="relative">
        <!-- <button id="dropdownButton1" class="menu-button hidden md:block px-4 py-2 text-lg text-white bg-green-cyan-shade bg-opacity-80 rounded hover:bg-opacity-100 transition duration-200   focus:outline-none focus:ring ring-blue-300">
          Menú
        </button> -->

        <!-- <button id="dropdownButton2" class="menu-button md:hidden py-2 flex flex-col gap-1 w-12 h-12 border-0 bg-transparent">
          <div class="bg-green-cyan-shade h-2 w-full rounded-lg transition-all duration-500 origin-right"></div>
          <div class="bg-green-cyan-shade h-2 w-full rounded-lg transition-all duration-500 origin-right"></div>
          <div class="bg-green-cyan-shade h-2 w-full rounded-lg transition-all duration-500 origin-right"></div>
        </button> -->

        <button id="dropdownButton2" class="menu-button py-2 flex flex-col gap-1 w-12 h-12 border-0 bg-transparent">
          <div class="bg-yellow-green-shade h-2 w-full rounded-lg transition-all duration-1000 origin-right"></div>
          <div class="bg-yellow-green-shade h-2 w-full rounded-lg transition-all duration-1000 origin-right"></div>
          <div class="bg-yellow-green-shade h-2 w-full rounded-lg transition-all duration-1000 origin-right"></div>
        </button>

        <div id="dropdownMenu" class="absolute right-0 mt-3 w-auto bg-white rounded-md shadow-lg hidden z-50">
          <ul class="text-gray-700">
            {% if session.logged_in %}              
              {% set informationComunLogged = [["Listar publicaciones", "/publicaciones"], ["Ver Perfil", "/profile"], ["Editar Perfil", "/edit_profile"]] %}                            
                {{ Menu.Menu(informationComunLogged) }}              
              {% if session.rol_id == 3 %} 
                <!-- {% set informationOwner = [["Registrar Donación en efectivo", ""], ["Registrar Donacion  de Produto", ""], ["Listar Intercambios Pendientes", ""], ["Listar Usuarios", "/generales"], ["Listar Colaboradores", "/colaboradores"], ["Registar Colaborador", "/registrarColaborador"], ["Listar Historial de Donaciones", ""]] %} -->
                {% set informationOwner =  [["Listar Usuarios", "/generales"], ["Listar Colaboradores", "/colaboradores"], ["Registar Colaborador", "/registrarColaborador"]] %}
                {{ Menu.Menu(informationOwner) }}
              {% elif session.rol_id == 2 %}
                <!-- {% set informationColaborador = [["Registrar Donación en efectivo", ""], ["Registrar Donacion  de Produto", ""], ["Listar Intercambios Pendientes", ""], ["Listar Usuarios", "/generales"]] %} -->
                {% set informationColaborador =  [["Listar Usuarios", "/generales"]] %}
                {{ Menu.Menu(informationColaborador) }}
               {% elif session.rol_id == 1 %}
                <!-- {% set informationGeneral = [["Subir Publicación", ""], ["Listar Mis Publicaciones", "/mispublicaciones"], ["Listar Ofertas Recibidas", ""], ["Listar Ofertas Enviadas", ""], ["Listar Notificaciones", ""], ["Listar Mi Historial de Donaciones", ""], ["Donar con Tarjeta", ""]] %} -->
                {% set informationGeneral = [["Subir Publicación", ""], ["Listar Mis Publicaciones", "/mispublicaciones"]] %}
                {{ Menu.Menu(informationGeneral) }}
                {% endif %}
              <li><a href="{{ url_for('root.logout') }}" class="block px-4 py-2 hover:bg-gray-100 whitespace-nowrap">Cerrar Sesión</a></li>
            {% else %}
              <li><a href="{{ url_for('root.login') }}" class="block px-4 py-2 hover:bg-gray-100 whitespace-nowrap">Iniciar Sesión</a></li>
              <li><a href="/registrar_usuario" class="block px-4 py-2 hover:bg-gray-100 whitespace-nowrap">Registrar Usuario</a></li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <div class="flex-1 flex flex-col overflow-x-hidden">
    {% block content %}Content placeholder{% endblock %}
  </div>
</div>
{% block body %}{% endblock %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var dropdownButtons = document.querySelectorAll('.menu-button');
    var dropdownMenu = document.getElementById('dropdownMenu');
  
    dropdownButtons.forEach(function(button) {
      button.addEventListener('click', function(event) {
        event.stopPropagation();
        this.classList.toggle('clicked');
        dropdownMenu.classList.toggle('hidden');
      });
    });
  
    window.addEventListener('click', function(event) {
      dropdownButtons.forEach(function(button) {
        if (!button.contains(event.target) && !dropdownMenu.contains(event.target)) {
          button.classList.remove('clicked');
          dropdownMenu.classList.add('hidden');
        }
      });
    });
  });  
</script>
{% endblock %}
